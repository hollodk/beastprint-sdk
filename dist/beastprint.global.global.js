"use strict";var beastprintGlobal=(()=>{async function c(t={}){var n;let e=(n=t.strategy)!=null?n:"auto";if(e==="legacy")return p(t.legacy);if(e==="beast")return l(t.beast);if(!!t.beast&&!!t.beast.printer&&typeof t.beast.printer.key=="string"&&t.beast.printer.key.length>0)try{await l(t.beast);return}catch(i){console.warn("[beastprint] BeastPrint failed, falling back to legacy",i)}if(t.legacy)return p(t.legacy);throw new Error("[beastprint] No valid print configuration provided")}async function p(t){if(!t||!t.html&&!t.url){if(typeof window!="undefined"&&typeof window.print=="function"){window.print();return}throw new Error("[beastprint] window.print() is not available")}if(t.url){if(typeof window=="undefined")throw new Error("[beastprint] Cannot open window in non-browser environment");let e=window.open(t.url,"_blank");if(!e)throw new Error("[beastprint] Popup blocked or failed to open window");e.addEventListener("load",()=>{try{e.focus(),e.print()}catch(r){console.error("[beastprint] Failed to print from opened window",r)}});return}if(t.html){if(typeof document=="undefined")throw new Error("[beastprint] Cannot create iframe in non-browser environment");let e=document.createElement("iframe");e.style.position="fixed",e.style.right="0",e.style.bottom="0",e.style.width="0",e.style.height="0",e.style.border="0",e.style.visibility="hidden",document.body.appendChild(e);let r=e.contentWindow;if(!r)throw e.remove(),new Error("[beastprint] Failed to access iframe.contentWindow");let n=r.document;n.open(),n.write(t.html),n.close(),e.onload=()=>{try{r.focus(),r.print()}catch(i){console.error("[beastprint] Failed to print from iframe",i)}finally{setTimeout(()=>{e.remove()},1e3)}};return}}async function l(t){var i,a,o;if(!t)throw new Error("[beastprint] No BeastPrint options provided");if(!t.printer||!t.printer.key)throw new Error("[beastprint] printer.key is required for BeastPrint");let e=(i=t.mode)!=null?i:"template",r={mode:e,widthMm:(a=t.widthMm)!=null?a:80,printer:{key:t.printer.key,profileKey:t.printer.profileKey}};if(e==="template"){if(!t.templateId)throw new Error('[beastprint] templateId is required when mode="template"');r.templateId=t.templateId,r.data=(o=t.data)!=null?o:{}}else if(e==="html"){if(!t.html)throw new Error('[beastprint] html is required when mode="html"');r.html=t.html}else throw new Error(`[beastprint] Unsupported mode: ${e}`);let n=await fetch("https://print.beastscan.com/print",{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){let s=`BeastPrint error: ${n.status}`;try{let d=await n.text();d&&(s+=` - ${d}`)}catch{}throw new Error(s)}}typeof window!="undefined"&&(window.beastprint={print:c});})();
//# sourceMappingURL=beastprint.global.global.js.map